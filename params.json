{"name":"Pilot nt.sberbank","tagline":"Sberbank pilot_nt.dll wrapper","body":"# Sberbank pilot_nt.dll DELPHI wrapper\r\n\r\nMade for Delphi 2010 or higher (Unicode). Maybe it works in 2009, but not tested.\r\n\r\n## Usage:\r\n\r\n### Пример снятия сверки итогов(закрытие дня). Example of usage CloseDay function\r\n\r\n<pre><code>// Пример снятия сверки итогов(закрытие дня)\r\n\r\nvar\r\n  PinPad: TPinPad;\r\nbegin\r\n  try\r\n    PinPad := TPinPad.Create;\r\n    if PinPad.TestPinPad then // Проверяем наличие пинпада\r\n    begin\r\n      if Pinpad.CloseDay = 0 then\r\n        ShowMessage(PinPad.Cheque) // Показать сообщение с отчетом\r\n      else\r\n        raise Exception.Create('Error!');\r\n    end\r\n    else\r\n      raise Exception.create('PinPad was not found');\r\n  finally\r\n    PinPad.Free;\r\n  end;\r\n\r\nend;\r\n</code></pre>\r\n\r\n### Пример проведения оплаты по карте. Example of payment usage\r\n\r\n<pre><code> // Пример проведения оплаты по карте на сумму 100 руб 20 коп\r\nvar\r\n  PinPad: TPinPad;\r\n  ok: boolean;\r\nbegin\r\n  try\r\n    PinPad := TPinPad.Create;\r\n    OK  := PinPad.CardAuth7(100.2, sberPayment) = 0;  // Авторизация карты\r\n    if OK then\r\n    begin\r\n      OK := PinPad.SuspendTrx = 0;                    // Если оплата прошла cтавим транзакцию на паузу\r\n        if OK then\r\n          begin\r\n            // Здесь мы можем печатать чек на ККМ, записать в БД или еще что-нибудь\r\n            // если все прошло успешно (чек записан в ККМ, например)\r\n            PinPad.CommitTrx;                         // фиксируем транзакцию\r\n            ShowMessage(PinPad.Cheque);               // и выводим сообщение с чеком-ответом от банка\r\n          end\r\n          else\r\n          begin\r\n            PinPad.RollBackTrx;                       // иначе отменяем транзакцию\r\n            ShowMessage('Не удалось совершить оплату');\r\n          end;\r\n    end;\r\n  finally\r\n    PinPad.Free;\r\n  end\r\nend;\r\n</pre></code>\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}